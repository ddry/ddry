// Generated by CoffeeScript 1.12.3

/*
 * Dotted name parser
 */

(function() {
  'use strict';
  module.exports = {
    fits: function(node, any) {
      if (any) {
        return typeof node !== 'undefined';
      }
      return typeof node === 'function';
    },
    parse: function(that, name, any, node) {
      var cursor, i, key, len, methodName, troddenPath, xPath;
      if (any == null) {
        any = true;
      }
      if (node == null) {
        node = false;
      }
      if (typeof that === 'function') {
        return that;
      }
      if (!(that && typeof that === 'object')) {
        return false;
      }
      xPath = name.split('.');
      if (xPath.length === 1) {
        if (node) {
          return [that, name, []];
        }
        return that[name];
      }
      methodName = xPath.pop();
      troddenPath = [];
      cursor = that;
      for (i = 0, len = xPath.length; i < len; i++) {
        key = xPath[i];
        if (typeof cursor[key] === 'object') {
          cursor = cursor[key];
          troddenPath.push(key);
        } else {
          return [troddenPath, key];
        }
      }
      if (node) {
        return [cursor, methodName, xPath];
      }
      if (this.fits(cursor[methodName], any)) {
        return cursor[methodName];
      }
      return [xPath, methodName];
    }
  };

}).call(this);
